2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_setup.py:_flush():68] Current SDK version is 0.19.10
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_setup.py:_flush():68] Configure stats pid to 1183154
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_setup.py:_flush():68] Loading settings from /root/.config/wandb/settings
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_setup.py:_flush():68] Loading settings from /root/codes/GUI-R1/wandb/settings
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /root/codes/GUI-R1/wandb/run-20250501_111605-wy88gyzd/logs/debug.log
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /root/codes/GUI-R1/wandb/run-20250501_111605-wy88gyzd/logs/debug-internal.log
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_init.py:init():852] calling init triggers
2025-05-01 11:16:05,605 INFO    MainThread:1183154 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'data': {'train_files': 'datasets/GUI-R1/train.parquet', 'val_files': 'datasets/GUI-R1/test.parquet', 'prompt_key': 'problem', 'answer_key': 'answer', 'image_key': 'images', 'max_prompt_length': 2048, 'max_response_length': 1024, 'rollout_batch_size': 512, 'val_batch_size': 256, 'system_prompt': None, 'shuffle': True, 'seed': 1, 'max_pixels': 1258291, 'min_pixels': 262144}, 'worker': {'hybrid_engine': True, 'actor': {'strategy': 'fsdp', 'global_batch_size': 128, 'micro_batch_size_per_device_for_update': 4, 'micro_batch_size_per_device_for_experience': 16, 'max_grad_norm': 1.0, 'clip_ratio': 0.2, 'ppo_epochs': 1, 'padding_free': True, 'ulysses_sequence_parallel_size': 1, 'use_torch_compile': True, 'model': {'model_path': 'Qwen/Qwen2.5-VL-3B-Instruct', 'tokenizer_path': 'Qwen/Qwen2.5-VL-3B-Instruct', 'override_config': {}, 'enable_gradient_checkpointing': True, 'trust_remote_code': False, 'freeze_vision_tower': False}, 'optim': {'lr': 1e-06, 'betas': [0.9, 0.999], 'weight_decay': 0.01, 'strategy': 'adamw', 'lr_warmup_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'training_steps': 90}, 'fsdp': {'enable_full_shard': True, 'enable_cpu_offload': False, 'enable_rank0_init': True, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': True, 'offload_optimizer': True}, 'global_batch_size_per_device': -1, 'disable_kl': False, 'use_kl_loss': True, 'kl_penalty': 'low_var_kl', 'kl_coef': 0.01}, 'critic': {'strategy': 'fsdp', 'global_batch_size': 256, 'micro_batch_size_per_device_for_update': 4, 'micro_batch_size_per_device_for_experience': 16, 'max_grad_norm': 1.0, 'cliprange_value': 0.5, 'ppo_epochs': 1, 'padding_free': False, 'ulysses_sequence_parallel_size': 1, 'model': {'model_path': None, 'tokenizer_path': None, 'override_config': {}, 'enable_gradient_checkpointing': True, 'trust_remote_code': True, 'freeze_vision_tower': False}, 'optim': {'lr': 1e-06, 'betas': [0.9, 0.999], 'weight_decay': 0.01, 'strategy': 'adamw', 'lr_warmup_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'training_steps': 90}, 'fsdp': {'enable_full_shard': True, 'enable_cpu_offload': False, 'enable_rank0_init': False, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': False, 'offload_optimizer': False}, 'global_batch_size_per_device': -1}, 'ref': {'strategy': 'fsdp', 'fsdp': {'enable_full_shard': True, 'enable_cpu_offload': True, 'enable_rank0_init': True, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': False, 'offload_optimizer': False}, 'micro_batch_size_per_device_for_experience': 16, 'padding_free': True, 'ulysses_sequence_parallel_size': 1, 'use_torch_compile': True}, 'reward': {'reward_type': 'function', 'compute_score': 'r1gui'}, 'rollout': {'name': 'vllm', 'n': 5, 'seed': 42, 'temperature': 1.0, 'top_p': 1.0, 'top_k': -1, 'limit_images': 0, 'dtype': 'bf16', 'gpu_memory_utilization': 0.6, 'ignore_eos': False, 'enforce_eager': False, 'free_cache_engine': False, 'enable_chunked_prefill': False, 'tensor_parallel_size': 1, 'max_num_batched_tokens': 8192, 'max_num_seqs': 1024, 'disable_log_stats': True, 'val_override_config': {'temperature': 0.5, 'n': 1}, 'prompt_length': 2048, 'response_length': 1024}}, 'algorithm': {'gamma': 1.0, 'lam': 1.0, 'adv_estimator': 'grpo', 'disable_kl': False, 'use_kl_loss': True, 'kl_penalty': 'low_var_kl', 'kl_coef': 0.01, 'kl_type': 'fixed', 'kl_horizon': 0.0, 'kl_target': 0.0}, 'trainer': {'total_episodes': 15, 'max_steps': None, 'project_name': 'easy_r1', 'experiment_name': 'qwen2_5_vl_3b_guir1_grpo', 'logger': ['console', 'wandb'], 'nnodes': 1, 'n_gpus_per_node': 2, 'critic_warmup': 0, 'val_freq': 5, 'val_before_train': True, 'val_only': False, 'val_generations_to_log': 1, 'save_freq': 5, 'save_limit': 3, 'save_checkpoint_path': 'checkpoints/easy_r1/qwen2_5_vl_3b_guir1_grpo', 'load_checkpoint_path': None}, '_wandb': {}}
2025-05-01 11:16:05,606 INFO    MainThread:1183154 [wandb_init.py:init():893] starting backend
2025-05-01 11:16:05,606 INFO    MainThread:1183154 [wandb_init.py:init():897] sending inform_init request
2025-05-01 11:16:05,612 INFO    MainThread:1183154 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-01 11:16:05,612 INFO    MainThread:1183154 [wandb_init.py:init():907] backend started and connected
2025-05-01 11:16:05,614 INFO    MainThread:1183154 [wandb_init.py:init():1002] updated telemetry
2025-05-01 11:16:05,619 INFO    MainThread:1183154 [wandb_init.py:init():1026] communicating run to backend with 90.0 second timeout
